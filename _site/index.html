<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>BeyondThunderdo.me</title>
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
    <link rel="shortcut icon" href="images/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
    <div id="header">
        <nav>
            <li class="fork"><a href="/">BeyondThunderdo.me</a></li>
            <li class="fork"><a href="/archive/">Archive</a></li>
        </nav>
    </div><!-- end header -->



    <div class="wrapper">

                <section>

    <div id="title">
        <h1>BeyondThunderdo.me</h1>
        <p>I make things. Sometimes I post them here.</p>
    </div>

    <div style="display:table, width: 50%">
    <hr>

        <div class="personalDescription">
            <img src="/images/RobertOnBeach.png" title="Thanks, Emma Ross :)">
            <h3>Robert Butler</h3>
            Software Engineer<br>
            <a href="http://twistedoakstudios.com/">Twisted Oak Studios</a><br>
            <a href="https://twitter.com/BoTreats"><img src="/images/twitterIcon.png" class="iconLinkImage"></a>
            <a href="https://github.com/rbrt"><img src="/images/githubIcon.png" class="iconLinkImage"></a>
            <a href="https://ca.linkedin.com/pub/robert-butler/ab/ab9/753"><img src="/images/linkedinIcon.png" class="iconLinkImage"></a>
            <a href="mailto:robbutler902@gmail.com"><img src="/images/mailIcon.png" class="iconLinkImage"></a>
        </div>
    </div>


    
        <div class="post">
            <h2 id="forest-drive">Forest Drive</h2>
<h5>January 22 2017</h5>

<p>This weekend I’ve been at the Global Game Jam spot in Halifax, but I’ve just
been continuing to work on <i>Mountain Drift</i>. For whatever reason, I’ve been
really motivated to keep working on this project, so I decided to keep riding that
momentum.</p>

<p>Before for my smoke, I was using sphere mesh particles with an additive particle
shader, and this was killing performance all the time. It was fine for a first pass,
but I needed to do something about it. In keeping with the low poly art style, I
hopped into Blonder and made a smoke mesh:</p>

<p><img src="/images/2017/Jan/SmokeMesh.png" /></p>

<p>Because this has a decent shape to it, I can use a shader that doesn’t do any alpha
blending. As soon as I made this change to my smoke particles, performance was no
longer a problem. I think I like the resulting effect more too, but this probably
isn’t the final pass.</p>

<p><img src="/images/2017/Jan/NewSmoke.gif" /></p>

<p>I also extended the track and added a finish line. At the base of the mountain,
there is the beginnings of a forest. I really want to look into various solutions
for creating nice backgrounds; I’d like to have a distant city, mountain ranges,
or a seemingly infinite forest and none of those are things I’ve tackled before.
For now, this is what the finish line looks like:</p>

<p><img src="/images/2017/Jan/Finish.gif" /></p>

        </div>

    	<hr>
    
        <div class="post">
            <h2 id="organization">Organization</h2>
<h5>January 19 2017</h5>

<p>For awhile now, I’ve been using <a href="https://trello.com/">Trello</a> for personal projects to help me stay
organized. I find that using anything is beneficial to help stay on track, as
it’s really easy otherwise to forget about something you noticed, or just not be
sure what to do next after completing a task. I used to keep lists, and at work
we use JIRA, but lists get really messy and JIRA is just overkill. Trello really
doesn’t scale well. At my last job we used it and it became very easy to lose track
of issues and it’s tedious to group tasks for sprints. However, for personal
projects, it’s great.</p>

<p><img src="/images/2017/Jan/Trello.gif" /></p>

<p>I set up different columns for each category of task that I can think of, and I
keep a “DONE” pile at the very beginning of my board. Keeping that list of
finished cards is a nice reminder of what’s been done lately, and it just feels
good to move tasks over there as they’re completed.</p>

<p>Beyond just keeping track of what needs to be done, I find it really useful to
be able to leave notes to myself for things to try. If I’m in the middle of
something and notice a gameplay tweak or art change that’s unrelated to what I’m
doing, it’s nice to be able to leave a quick note to myself in the relevant column
so I can remember to look into it later.</p>

<p>I also really like being able to attach images to cards, because I have a whiteboard
in my office at home, and I find this is a really nice way to keep whatever I draw
there organized and archived. Then I can clear my whiteboard without having to worry
about erasing something important.</p>

<p><img src="/images/2017/Jan/WhiteboardTrello.png" /></p>

        </div>

    	<hr>
    
        <div class="post">
            <h2 id="mountain-drift">Mountain Drift</h2>
<h5>January 17 2017</h5>

<p>I’ve worked a bit more on the drifting game, and I now have a tentative title:</p>

<p><img src="/images/2017/Jan/MountainDrift.gif" /></p>

<p>I’ve done a bit of menu work, created a system for recording and playing back
replays, created that title screen, added a system for detecting and scoring drifts,
added destructible objects, made the car explode when you fly off the road, and
added some first pass smoke effects.</p>

<p>For the menu, I took the approach of having multiple Canvases for different contexts
that are all managed by a top level object. This object can smoothly transition
between menus as the game goes from the title, to gameplay, to failure, and so on.
I made a utility component that will ensure that certain objects on a prefab are
always enabled when you apply changes to the prefab. This is useful on the menu
so that I can disable all of the other canvases to work on one at a time, and not
worry about accidentally saving disabled canvases. If I didn’t take this approach,
this is what I would be working with:</p>

<p><img src="/images/2017/Jan/Menus.png" /></p>

<p>For replays, I made a component that you can place on a car, and then it will
record the transform’s position and rotation at every frame. It also records whether
or not the tires are smoking, and can be extended to record other necessary data
pretty easily. The data is stored in a ScriptableObject for now, but I’m going to
serialize it in a different manner if I wind up making an in-game record replay
feature. To play it back, a similar component is placed on a stripped down car
object, and then all of the recorded info is played back each frame. I used it to
make the title sequence at the top of this post.</p>

<p>For detecting drifts, I’m just looking at the direction the car is traveling and
comparing it against the car’s forward vector. I’m combining this information with
the speed at which the car is traveling, and using it to provide a “drift intensity”
that is used to determine when effects like smoke and skid marks should be enabled,
and also what score multipliers to apply.</p>

<p><img src="/images/2017/Jan/DriftScore.gif" /></p>

        </div>

    	<hr>
    
        <div class="post">
            <h2 id="drifting-game">Drifting Game</h2>
<h5>January 10 2017</h5>

<p>I’ve been playing a lot of Forza Horizon 3 since it came out last year, and it’s
a total blast. The events in the game aren’t so great, but just driving around
the “mini Australia” they’ve created is both entertaining and relaxing. What
I’ve really come to enjoy is drifting around the mountains and hills. The sound
of tires squealing, the trail of smoke, and the feeling of controlling the car
while it gets sideways is something I’ve been coming back to for months.</p>

<p>I wanted to try and capture that feeling and make a game that was about only that.
I started off by looking into Unity’s standard car asset. I was able to get some
interesting results after several hours of messing around with physics settings;
four wheel drive with reduced friction on the rear wheels seemed the let the car
slide around a lot. Unfortunately, even at the best settings I managed to find,
I found that the settings weren’t general. What worked for sliding would lead to
a car that could barely accelerate in a straight line. It would also be prone to
spinning out. I attempted to change between settings on the fly, but the handling
was still not something I was happy with.</p>

<p>Before continuing on any further, I had to make a little car and a mountain scene
to drive it around in. I wound up making a track by extruding a mesh along a path
in Blonder and applying a road texture to it, then I surrounded it with a bunch of
mountains.</p>

<p><img src="/images/2017/Jan/Mountains.png" /></p>

<p>After that, I took a stab at making a low poly AE86:</p>

<p><img src="/images/2017/Jan/AE86.png" /></p>

<p>Next up I tried slapping a rigidbody on my car and applying forces to it manually.
I found that applying torque to turn was heavily dependent on how much contact the
collider had with the ground, but applying forward momentum worked consistently well.
The solution I wound up utilizing was to apply force to the rigidbody, but then
to bypass physics for rotation and rotate the transform directly.</p>

<p>This actually feels pretty good, and the car can be adjusted to feel pretty different
(without being out of control) by tweaking max speed, acceleration, and turn speed.
Most importantly, the car is really drift-happy, which is exactly what I wanted.
I made a build and put it on my phone, and even though there wasn’t much to it,
it made me feel the same way I felt sliding around in Forza. I’m going to keep at
it.</p>

        </div>

    	<hr>
    
        <div class="post">
            <h2 id="transition-effect">Transition Effect</h2>
<h5>July 10 2016</h5>

<p>Wow, it’s been awhile since the last post! I hadn’t worked on my transition
effect much over the last few months due to a pretty hectic period at work, but
last week I got things solved and managed to make a fairly general package
that can be dropped into any project. The end result is this:</p>

<p><img src="/images/2016/July/TransitionDemonstration.gif" /></p>

<p>It’s a transition between two test scenes that both occupy the same space in
world coordinates, have different geometry, have different ambient light, have
different UI canvases, and have different scene lights. Despite neither scene
being particularly interesting, the GIF above demonstrates how all of the
information contained in each scene is preserved and nothing is rendered twice.</p>

<p>To achieve this effect, there are two main components used. The first is a
SceneTransitionObject, or STO, and the second is the TransitionController.</p>

<p>Any scene that we want to transition to or from needs an STO, and right now it needs
to be the root of all objects in the scene. This isn’t absolutely required, but
we would need to do an expensive FindObjectsOfType call instead of a
GetComponentsInChildren call if we didn’t follow this guideline. An STO has
references to all of the lights, cameras, canvases, and renderers in a scene and
in Awake it will figure out if it is the current STO, or the next STO. In other
words, is it the <em>from</em> or <em>to</em> STO in the transition? All of an STO’s cameras
are disabled and rendered manually every frame, which gives us total control
over what we’re displaying.</p>

<p>The TransitionController has two RenderTextures (from and to) and a camera that
is ultimately responsible for rendering everything in the game. It can either be
rendering the contents of the “from” STO, the “to” STO, or some combination of
the two. When a transition is invoked, a special shader is used to smoothly
transition from the “from” texture to the “to” texture. To do this, the shader
needs to support two textures, and take an interpolation value.
The transition controller in the scene view looks like this:</p>

<p><img src="/images/2016/July/RenderingQuad.png" /></p>

<p>A transition needs to be invoked when a new scene containing an STO is loaded
additively. The TransitionController will yield on the existence of a new STO,
and then it will use the following code to control individual rendering of each
scene once per frame:</p>

<p><img src="/images/2016/July/RenderTransitionFrameSample.png" /></p>

<p>What is happening here is as follows: We disable all of the renderers and lights
in the new scene, and then we call the current scene’s STO’s RenderFrame method.
This will trigger a render to our “from” RenderTexture. Then we turn on all of
the renderers and lights in the new scene, disable all of the renderers and lights
in the current scene, and render the contents of the next scene to the “to” RenderTexture.
This continues until the transition is done, at which point we set the “to” STO to
be the current one (or, the “from” STO), unload the previous scene, and resume
rendering only the “from” STO’s contents.</p>

<p>Using this technique, any shader that interpolates between textures can be inserted
and used to transition from gameplay to menu screens, gameplay to gameplay… or
whatever really. Here’s an example of it in action to transition from a title screen
to gameplay in a side project I’m occasionally hacking on:</p>

<p><img src="/images/2016/July/GameTransition.gif" /></p>

<p>I plan to make this available on the asset store or on GitHub or something
eventually. I just need to write up a bit of documentation and handle a few edge
cases.</p>

        </div>

    	<hr>
    

    <a href="/archive/"><h1 style="text-align:center; margin-top:5%;">Older Posts</h1></a>



</section>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-53820142-1', 'auto');
        ga('send', 'pageview');
    </script>
  </body>
</html>
